---
name: learnings
description: When learning from review feedback or applying learned preferences to reviews.
uses:
  - storage
---

Learn and apply team review preferences through natural language feedback.

## Types

$Learning: /a natural language statement about review preferences/
$LearningScope: "file" | "path" | "repo" | "org"
$LearningSource: "feedback" | "config" | "guideline"

## Input

- $action: "learn" | "apply" | "list"
- $context: $String                     <!-- file path or feedback text -->
- $prNumber: $Number = 0

## Context

- $learnings: $Learning[] = []
- $applicableLearnings: $Learning[] = []

## Workflow

### Learn Action

When $action = "learn", extract and store a new learning from feedback.

1. Parse the feedback in $context to identify:
   - The preference being expressed
   - Why it matters (the reasoning)
   - What scope it applies to (file, path pattern, or repo-wide)

2. Formulate the learning as a self-instructive statement:
   - Start with the scope: "In [scope]..."
   - State the preference clearly
   - Include the reasoning

3. Execute [[storage#append]] WITH:
   - $scope = "repo"
   - $path = "learnings.md"
   - $content = /formatted learning entry with date and source/

4. Confirm the learning was recorded

### Apply Action

When $action = "apply", retrieve learnings relevant to a file being reviewed.

1. Execute [[storage#read]] WITH:
   - $scope = "repo"
   - $path = "learnings.md"

2. Parse the learnings file into $learnings

3. FOR EACH $learning IN $learnings:
   - IF /learning scope matches $context path/ THEN:
     - Add $learning to $applicableLearnings

4. Return $applicableLearnings for use in review

### List Action

When $action = "list", display all stored learnings.

1. Execute [[storage#read]] WITH:
   - $scope = "repo"
   - $path = "learnings.md"

2. Format and return the learnings organized by scope

## Learning from Feedback

When a reviewer provides feedback on a CodeRabbit comment, analyze it:

### Feedback Patterns

**Disagreement with suggestion:**
> "Actually, we prefer X because Y"

Extract: Preference for X, reasoning is Y, scope is /inferred from file path/

**Clarification:**
> "This is intentional because Z"

Extract: Exception for this pattern, reasoning is Z, scope is specific file or pattern

**Style preference:**
> "We always use A instead of B in this codebase"

Extract: Style rule A over B, scope is repo-wide

### Learning Quality

Good learnings are:
- Specific enough to apply consistently
- Include reasoning (the "why")
- Scoped appropriately (not too broad, not too narrow)

Avoid creating learnings for:
- One-off exceptions unlikely to recur
- Contradictions with existing learnings
- Vague preferences without clear guidance

## Detecting Existing Guidelines

On first review of a repository, check for existing guideline files:

1. Look for guideline files:
   - `.cursorrules`
   - `CLAUDE.md`
   - `.github/copilot-instructions.md`
   - `CODING_STANDARDS.md`
   - `AGENTS.md`

2. IF /guideline files found/ THEN:
   - Parse content into learnings
   - Mark source as "guideline"
   - Store with repo-wide scope

3. Execute [[storage#write]] WITH:
   - $scope = "repo"
   - $path = "guidelines.md"
   - $content = /summary of detected guidelines/
