---
import BaseLayout from "../../layouts/BaseLayout.astro";
import MdzCodeBlock from "@web2/components/MdzCodeBlock.astro";

export async function getStaticPaths() {
  const files = import.meta.glob("../../../../docs/examples/**/*.mdz");
  return Object.keys(files)
    .map((path) => path.replace("../../../../docs/examples/", "").replace(/\.mdz$/, ""))
    .map((slug) => ({ params: { slug } }));
}

const files = import.meta.glob("../../../../docs/examples/**/*.mdz", {
  query: "?raw",
  import: "default",
});

const slugParam = Astro.params.slug;
const slug = Array.isArray(slugParam) ? slugParam.join("/") : slugParam ?? "";
const filePath = `../../../../docs/examples/${slug}.mdz`;
const load = files[filePath];

if (!load) {
  throw new Error(`Example not found: ${filePath}`);
}

const source = await load();
---

<BaseLayout title={`MDZ Examples - ${slug}`}>
  <h1>{slug}</h1>
  <MdzCodeBlock source={source} />
</BaseLayout>
