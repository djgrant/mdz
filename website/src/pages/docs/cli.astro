---
import DocsLayout from '../../layouts/DocsLayout.astro';
---

<DocsLayout title="CLI">
  <h1>Command Line Interface</h1>
  
  <p class="lead">
    Use the MDZ CLI to validate, compile, and inspect skills.
  </p>

  <h2>Installation</h2>
  
  <pre><code class="language-bash">npm install -g zenmarkdown</code></pre>

  <h2>Commands</h2>
  
  <h3>check</h3>
  
  <p>Validate a skill for errors—the primary command:</p>
  
  <pre><code class="language-bash">mdz check &lt;file&gt;</code></pre>
  
  <p>
    This validates syntax, references, type contracts, and dependencies. Errors are 
    caught here—before the LLM ever sees the skill.
  </p>

  <h4>What It Checks</h4>
  
  <ul>
    <li><strong>Syntax</strong> — Valid MDZ constructs</li>
    <li><strong>Links</strong> — <code>~/skill/name</code> and <code>~/agent/name</code> targets exist</li>
    <li><strong>Anchors</strong> — <code>#section</code> targets exist</li>
    <li><strong>Types</strong> — Contracts match across boundaries</li>
    <li><strong>Dependencies</strong> — No circular references</li>
    <li><strong>Scope</strong> — Variables defined before use</li>
  </ul>

  <h4>Example</h4>
  
  <pre><code class="language-bash">mdz check my-skill.mdz

✓ my-skill.mdz is valid
  Types: 3
  Variables: 5
  Dependencies: 2</code></pre>

  <h3>compile</h3>
  
  <p>Validate and output a skill (source unchanged):</p>
  
  <pre><code class="language-bash">mdz compile &lt;file&gt; [options]</code></pre>

  <h4>Options</h4>
  
  <ul>
    <li><code>-o, --output &lt;file&gt;</code> — Write output to file</li>
    <li><code>-V, --verbose</code> — Show validation summary</li>
    <li><code>--source-map</code> — Generate source map</li>
    <li><code>--metadata</code> — Generate metadata JSON</li>
  </ul>
  
  <p>
    The compiler validates the skill and outputs the source unchanged. MDZ is 
    validator-first: the LLM sees exactly what you wrote.
  </p>

  <h4>Example</h4>
  
  <pre><code class="language-bash"># Validate and write to output file
mdz compile skill.mdz -o skill.out.mdz

# Show validation summary
mdz compile skill.mdz -V</code></pre>

  <h3>parse</h3>
  
  <p>Output the AST as JSON (useful for tooling integration):</p>
  
  <pre><code class="language-bash">mdz parse &lt;file&gt;</code></pre>

  <h3>graph</h3>
  
  <p>Output the dependency graph for a skill:</p>
  
  <pre><code class="language-bash">mdz graph &lt;file&gt; [options]</code></pre>
  
  <h4>Options</h4>
  
  <ul>
    <li><code>--mermaid</code> — Output Mermaid format</li>
    <li><code>--dot</code> — Output GraphViz DOT format</li>
    <li>(default is JSON)</li>
  </ul>
  
  <p>
    Shows which files are linked from your skill.
  </p>

  <h2>Exit Codes</h2>
  
  <ul>
    <li><code>0</code> — Success (validation passed)</li>
    <li><code>1</code> — Error (validation failed, file not found, etc.)</li>
  </ul>

  <h2>Integration with CI/CD</h2>
  
  <p>
    Run <code>mdz check</code> in your pipeline to catch errors before deployment:
  </p>
  
  <pre><code class="language-yaml"># GitHub Actions example
- name: Validate skills
  run: mdz check ./skills/**/*.mdz</code></pre>
</DocsLayout>
