---
import DocsLayout from '../../layouts/DocsLayout.astro';
---

<DocsLayout title="Syntax Reference">
  <h1>Syntax Reference</h1>
  
  <p class="lead">
    Complete reference for MDZ syntax, from document structure to control flow.
  </p>

  <h2>Document Structure</h2>
  
  <p>An MDZ document is a valid markdown file with these extensions:</p>
  
  <pre><code><span class="zen-comment">---
frontmatter (YAML)
---</span>

<span class="zen-heading"># Heading</span>

Body content with zen constructs</code></pre>

  <h3>Frontmatter</h3>
  
  <p>Required and optional fields in YAML frontmatter:</p>
  
  <pre><code><span class="zen-comment">---
name: skill-name              # Required: identifier (kebab-case)
description: When...          # Required: trigger description
uses:                         # Optional: skill dependencies
  - skill-a
  - skill-b
---</span></code></pre>

  <h2>Types</h2>
  
  <h3>Type Definitions</h3>
  
  <p>Types provide semantic hints about values:</p>
  
  <pre><code><span class="zen-type">$TypeName</span> = natural language description

<span class="zen-type">$Task</span> = any task that an agent can execute
<span class="zen-type">$Strategy</span> = <span class="zen-string">"accumulate"</span> | <span class="zen-string">"independent"</span>
<span class="zen-type">$Result</span> = <span class="zen-string">"success"</span> | <span class="zen-string">"failure"</span> | <span class="zen-string">"pending"</span></code></pre>

  <h3>Type Syntax</h3>
  
  <ul>
    <li><strong>Semantic</strong>: <code>$Task = any executable instruction</code></li>
    <li><strong>Enum</strong>: <code>$Strategy = "fast" | "thorough"</code></li>
    <li><strong>Compound</strong>: <code>($Task, $Strategy)</code></li>
    <li><strong>Array</strong>: <code>$Task[]</code></li>
    <li><strong>Function</strong>: <code>$Fn = $x =&gt; expression</code></li>
  </ul>

  <h2>Variables</h2>
  
  <h3>Declaration</h3>
  
  <pre><code><span class="zen-variable">$name</span>: <span class="zen-type">$Type</span> = value
<span class="zen-variable">$name</span> = value</code></pre>

  <h3>Examples</h3>
  
  <pre><code>- <span class="zen-variable">$current</span>: <span class="zen-type">$FilePath</span> = <span class="zen-variable">$SolutionPath</span>(0)
- <span class="zen-variable">$iterations</span> = 0
- <span class="zen-variable">$result</span>: <span class="zen-type">$ValidationResult</span></code></pre>

  <h3>Lambda Expressions</h3>
  
  <pre><code><span class="zen-type">$FunctionName</span> = <span class="zen-variable">$param</span> =&gt; expression
<span class="zen-type">$FunctionName</span> = (<span class="zen-variable">$a</span>, <span class="zen-variable">$b</span>) =&gt; expression

<span class="zen-type">$SolutionPath</span> = <span class="zen-variable">$n</span> =&gt; `output-<span class="zen-variable">$n</span>.md`</code></pre>

  <h2>References</h2>
  
  <h3>Skill References</h3>
  
  <pre><code><span class="zen-reference">[[skill-name]]</span></code></pre>

  <h3>Section References</h3>
  
  <pre><code><span class="zen-reference">[[skill-name#section-name]]</span>   <span class="zen-comment"># Section in another skill</span>
<span class="zen-reference">[[#section-name]]</span>             <span class="zen-comment"># Section in current skill</span></code></pre>

  <h2>Semantic Markers</h2>
  
  <p>Mark content for LLM interpretation:</p>
  
  <pre><code><span class="zen-semantic">&#123;~~appropriate location for this output&#125;</span>
<span class="zen-semantic">&#123;~~determine best strategy for <span class="zen-variable">$task</span>&#125;</span></code></pre>

  <p>Variables are expanded before interpretation:</p>
  
  <pre><code><span class="zen-semantic">&#123;~~the path for candidate <span class="zen-variable">$n</span>&#125;</span>
<span class="zen-comment"># First $n is resolved, then LLM interprets</span></code></pre>

  <h2>Control Flow</h2>
  
  <h3>FOR EACH</h3>
  
  <pre><code><span class="zen-keyword">FOR EACH</span> <span class="zen-variable">$item</span> <span class="zen-keyword">IN</span> <span class="zen-variable">$collection</span>:
  - Process <span class="zen-variable">$item</span>
  - Next step

<span class="zen-keyword">FOR EACH</span> (<span class="zen-variable">$task</span>, <span class="zen-variable">$strategy</span>) <span class="zen-keyword">IN</span> <span class="zen-variable">$transforms</span>:
  - Execute <span class="zen-variable">$task</span> with <span class="zen-variable">$strategy</span></code></pre>

  <h3>WHILE</h3>
  
  <pre><code><span class="zen-keyword">WHILE</span> (condition <span class="zen-keyword">AND</span> <span class="zen-variable">$iterations</span> &lt; 5):
  - Perform iteration
  - Update state</code></pre>

  <h3>IF/THEN/ELSE</h3>
  
  <pre><code><span class="zen-keyword">IF</span> <span class="zen-variable">$condition</span> <span class="zen-keyword">THEN</span>:
  - Do this
<span class="zen-keyword">ELSE</span>:
  - Do that

<span class="zen-keyword">IF</span> <span class="zen-variable">$strategy</span> = <span class="zen-string">"accumulate"</span> <span class="zen-keyword">THEN</span>:
  - Validate incrementally
<span class="zen-keyword">ELSE</span>:
  - Collect all candidates</code></pre>

  <h2>Composition</h2>
  
  <h3>Skill Delegation</h3>
  
  <pre><code>Execute <span class="zen-reference">[[orchestrate-map-reduce]]</span> <span class="zen-keyword">WITH</span>:
  - <span class="zen-variable">$transforms</span> = [(<span class="zen-string">"Apply heuristic"</span>, <span class="zen-string">"accumulate"</span>)]
  - <span class="zen-variable">$validator</span> = <span class="zen-reference">[[#validate-essence]]</span>
  - <span class="zen-variable">$return</span> = <span class="zen-string">"Report findings"</span></code></pre>

  <h3>Parameter Passing</h3>
  
  <pre><code>Delegate to <span class="zen-reference">[[skill-name]]</span> <span class="zen-keyword">WITH</span>:
  - <span class="zen-variable">$param1</span> = value1
  - <span class="zen-variable">$param2</span> = value2</code></pre>

  <h2>Conventional Sections</h2>
  
  <p>While not required, these sections are conventional:</p>
  
  <pre><code><span class="zen-heading">## Types</span>
Type definitions

<span class="zen-heading">## Input</span>
Input parameter declarations

<span class="zen-heading">## Context</span>
Contextual variable declarations

<span class="zen-heading">## Workflow</span>
Main execution steps

<span class="zen-heading">## [Section Name]</span>
Reusable prompts/sub-sections</code></pre>
</DocsLayout>
